{% extends 'base.html' %}

{% block content %}

<div class="container p-5 bg-annapolis-blue rounded-10" style="min-height: calc(100vh - 275px);">
    <!-- Button trigger modal -->
    <div class="text-center">
        {% for proyecto in proyectos %}
        <a class="m-1" href="#" data-bs-toggle="modal" data-bs-target="#item_{{ proyecto.id }}"
            style="color: inherit; text-decoration: inherit; display: inline-block;">
            <div class="card text-center bg-midnight-express rounded-10 zoom-in zoom-out" style="width: 18rem;">
                <div style="width: 100%; height: 180px;">
                    <img src="https://img.4plebs.org/boards/pol/image/1685/15/1685159872624558.jpg" class="card-img-top"
                        alt="yugiweed" style="height: 180px; object-fit: cover;">
                </div>
                <div class="card-body">
                    <h5 class="card-title text-uppercase">{{ proyecto.nombre }}</h5>
                    <p class="card-text">{{ proyecto.descripcion }}</p>
                </div>
            </div>
        </a>
        {% endfor %}
    </div>
    <!-- Modal -->
    {% for proyecto in proyectos %}
    <div class="modal fade" id="item_{{ proyecto.id }}" tabindex="-1" aria-labelledby="projectModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl modal-fullscreen-lg-down">
            <div class="modal-content bg-annapolis-blue rounded-10">
                <div class="modal-header">
                    <h2 class="modal-title text-capitalize" id="projectModalLabel">{{ proyecto.nombre }}</h2>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div style="width: 100%; height: 240px;">
                        <img class="d-block mx-auto rounded-10"
                            src="https://img.4plebs.org/boards/pol/image/1685/15/1685159872624558.jpg" alt="yugiweed"
                            style="height: 100%; width: 450px; max-width: 100%;  object-fit: cover;">
                    </div>

                    <div class="container mt-3">
                        <div class="row">
                            <div class="col-lg-7">
                                <div class="bg-midnight-express rounded-5 text-center mb-3"
                                    style="width: 80%; height: 400px;">
                                    Tareas
                                </div>
                            </div>
                            <div class="col-lg-5">
                                <div class="row">
                                    <div class="d-flex justify-content-between bg-midnight-express rounded-10">
                                        <h3 class="fw-bolder fs-4 lh-base">Información del proyecto</h3>
                                        <button type="button" class="btn">
                                            <i
                                                class="fa-solid fa-pen-to-square text-distant-horizon zoom-in zoom-out"></i>
                                        </button>
                                    </div>
                                    <ul class="list-group">
                                        <li class="list-group-item border-0 bg-transparent text-distant-horizon"><span
                                                class="fw-bold">Constructora: </span>{{ proyecto.constructora.nombre }}
                                        </li>
                                        <li class="list-group-item border-0 bg-transparent text-distant-horizon"><span
                                                class="fw-bold">Fecha de inicio: </span>{{ proyecto.fecha_inicio }}</li>
                                        <li class="list-group-item border-0 bg-transparent text-distant-horizon"><span
                                                class="fw-bold">Fecha de finalización: </span>{{ proyecto.fecha_final }}
                                        </li>
                                        <li class="list-group-item border-0 bg-transparent text-distant-horizon"><span
                                                class="fw-bold">Presupuesto: </span>{{ proyecto.presupuesto }}</li>
                                        <li class="list-group-item border-0 bg-transparent text-distant-horizon"><span
                                                class="fw-bold">Estado: </span>{{ proyecto.estado }}</li>
                                    </ul>
                                </div>
                                <hr>
                                <div class="row">
                                    <div class="d-flex justify-content-between bg-midnight-express rounded-10">
                                        <h3 class="fw-bolder fs-4 lh-base">Personal</h3>
                                        <button type="button" class="btn text-distant-horizon zoom-in zoom-out"
                                            data-bs-target="#busqueda-usuario" data-bs-dismiss="modal" data-bs-toggle="modal">
                                            <i class="fa-solid fa-plus"></i>
                                        </button>
                                    </div>
                                    <ul>
                                        {% for usuario in usuarios %}
                                        {% if proyecto == usuario.id_proyecto %}
                                        <li class="list-group-item border-0 bg-transparent text-distant-horizon">
                                            <div class="fw-bold">{{ usuario.id_usuario.first_name }}</div>
                                            Ingeniero Civil
                                        </li>
                                        {% endif %}
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="agregar-usuario-modal" tabindex="-1" aria-labelledby="projectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered" style="max-height: 250px;">
            <div class="modal-content bg-annapolis-blue rounded-10">
                <div class="modal-header">
                    <h2 class="modal-title text-capitalize" id="profileModalLabel">Perfil de Usuario</h2>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="d-flex justify-content-center rounded-circle">
                        <img class="m-3" src="https://avatar.iran.liara.run/public/36" alt="Perfil" style="height: 120px;">
                    </div>
                    <div class="text-center">
                        <div class="fw-bold">{{ usuario_actual.first_name }} {{ usuario_actual.last_name }}</div>
                        <div>{{ usuario_actual.documento }}</div>
                        <div>{{ usuario_actual.email }}</div>
                        <div class="d-flex justify-content-center">
                            <select class="form-select text-center" style="max-width: 60%;">
                                <option>Seleccionar Rol</option>
                                <option value="1">Constructor</option>
                                <option value="2">Mario</option>
                                <option value="3">Yugiweed</option>
                                <option value="4">Audi</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#busqueda-usuario">Atrás</button>
                    <button type="button" class="btn bg-midnight-express text-distant-horizon" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#item_{{ proyecto.id }}">Agregar</button>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
    <div class="modal fade" id="busqueda-usuario" tabindex="-1" aria-labelledby="projectModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
            <div class="modal-content bg-annapolis-blue rounded-10">
                <div class="modal-body">
                    <input type="email" name="busqueda" id="busqueda" class="form-control text-distant-horizon"
                        placeholder="Correo del empleado a agregar.">
                    <ul class="list-group">
                        <a href="#" data-bs-dismiss="modal" data-bs-toggle="modal" data-bs-target="#agregar-usuario-modal">
                            <li class="list-group-item border-0 bg-transparent text-distant-horizon">
                                <div class="row">
                                    <div class="col-4">
                                        <img class="m-3" src="https://avatar.iran.liara.run/public/36" alt="Perfil"
                                            style="height: 64px;">
                                    </div>
                                    <div class="col-8 d-flex align-items-center">
                                        <div>
                                            <div class="fw-bold">Vicente Van Coco</div>
                                            <div>vicentev@ncoco.com</div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </a>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <a class="btn d-flex justify-content-center align-items-center bg-light rounded-circle text-midnight-express zoom-in zoom-out"
        href="/nuevo-proyecto" style="height: 64px; width: 64px; position: fixed; right: 64px; bottom: 64px;">
        <i class="fa-solid fa-plus"></i>
    </a>
</div>

{% endblock %}