{% load static %}
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Registro</title>
	<script src="https://kit.fontawesome.com/fb4d809d7a.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

	<!-- Mobile Specific Metas -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<!-- Font-->
	<link rel="stylesheet" type="text/css" href="{% static 'css/montserrat-font.css' %}">
	<link rel="stylesheet" type="text/css" href="{% static 'fonts/material-design-iconic-font/css/material-design-iconic-font.min.css' %}">
	<!-- Main Style Css -->
    <link rel="stylesheet" href="{% static 'css/signup.css' %}"/>
	<style>
        .bg-distant-horizon {
            background: #F1F6F9 !important;
        }

        .bg-midnight-express {
            background: #212A3E !important;
        }

        .text-annapolis-blue {
            color: #394867 !important;
        }

        .text-distant-horizon {
            color: #F1F6F9 !important;
        }

        .text-midnight-express {
            color: #212A3E !important;
        }

        .rounded-10 {
            border-radius: 10px !important;
        }

        .dropdown-item:hover {
            background: #212A3E !important;
        }

        .zoom-out {
            transition: transform 0.2s;
            transform: scale(1.0);
        }

        .zoom-in:hover {
            transform: scale(1.1);
        }

        /* body nav.navbar div.container {
            transition: padding 0.2s;
        } */
    </style>
</head>
<body class="form-v10 bg-midnight-express text-distant-horizon">
	<nav class="navbar navbar-expand-lg py-4 sticky-top bg-midnight-express text-distant-horizon">
        <div class="container" id="navbar">
            <a class="navbar-brand" href="/">
                <img src="{% static 'assets/img/CivilPro_Logo_W.png' %}" alt="CivilPro" style="height: 80px;">
            </a>
            </div>
        </div>
    </nav>
	<div class="page-content" style="top: 128px; min-height: calc(100vh - 275px);">
		<div class="form-v10-content">
			<form class="form-detail" method="post" id="myform">
				{% csrf_token %}
				<div class="form-left">
					<h2>Registro de Usuario</h2>
					<div class="form-group">
						<div class="form-row form-row-1">
							<input type="text" name="first_name" id="first_name" class="input-text" placeholder="Nombre" value="{{ data.first_name }}" required>
						</div>
						<div class="form-row form-row-2">
							<input type="text" name="last_name" id="last_name" class="input-text" placeholder="Apellido" value="{{ data.last_name }}" required>
						</div>
					</div>
					<div class="form-row scroll-container">
						<p class="text-midnight-express">Seleccione sus especializaciones:</p>
						{% for degree in degrees %}
							<div class="form-checkbox">
								<label class="container">
									<p>{{ degree.name }}</p>
									<input type="checkbox" name="titles[]" value="{{ degree.name }}">
									<span class="checkmark"></span>
								</label>
							</div>
						{% endfor %}
					</div>
					<div class="form-group">
						<div class="form-row form-row-1">
							<input type="password" name="password" id="password" class="password" placeholder="Contraseña" value="{{ data.password }}" required>
						</div>
						<div class="form-row form-row-2">
							<input type="password" name="repassword" id="repassword" class="repassword" placeholder="Repetir Contraseña" value="{{ data.repassword }}" required>
						</div>
					</div>
				</div>
				<div class="form-right">
					<h2></h2>
					<div class="form-group">
						<div class="form-row form-row-1">
							<input type="number" name="code" class="code" id="code" placeholder="+" value="{{ data.code }}" required>
						</div>
						<div class="form-row form-row-2">
							<input type="number" name="phone" class="phone" id="phone" placeholder="Número de Teléfono" value="{{ data.phone }}" required>
						</div>
					</div>
					<div class="form-row">
						<input type="text" name="your_email" id="your_email" class="input-text" value="{{ data.your_email }}" required pattern="[^@]+@[^@]+.[a-zA-Z]{2,6}" placeholder="Correo Electronico">
					</div>
					<div class="form-row">
						<input type="number" name="doc_id" class="doc_id" id="doc_id" placeholder="Número de Documento" value="{{ data.doc_id }}" required>
					</div>
					
					<div class="form-row-last">
						<input type="submit" name="register" class="register" value="Registrar">
						<div class="text-center pt-3 text-muted">¿No tienes cuenta? <a href="/signupcon">Regístrate como constructora</a></div>
					</div>
					<h2></h2>
					
				</div>
			</form>
		</div>
	</div>
	<div class="container">
        <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
            <div class="col-md-4 d-flex align-items-center">
                <span class="text-muted">2024 CivilPro&trade;</span>
            </div>

            <a href="/">
                <img src="{% static 'assets/img/CivilPro_Logo_W.png' %}" alt="CivilPro" style="height: 50px;">
            </a>

            <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
                <li class="ms-3">
                    <a class="text-muted" href="mailto:contact@civilpro.org">contact@civilpro.org</a>
                </li>
                <li class="ms-3"><a class="text-muted" href="mailto:contact@civilpro.org"><i
                            class="fa-regular fa-envelope"></i></a></li>
            </ul>
        </footer>
    </div>
	<script>
		var errorMessage = "{{ error }}";
		if (errorMessage) {
			alert(errorMessage);
		}
	
		document.getElementById("myform").addEventListener("submit", function(event) {
			var checkboxes = document.querySelectorAll('input[type="checkbox"]');
			var alMenosUnoSeleccionado = false;
			
			checkboxes.forEach(function(checkbox) {
				if (checkbox.checked) {
					alMenosUnoSeleccionado = true;
				}
			});
			if (!alMenosUnoSeleccionado) {
				alert('Por favor, seleccione al menos un título.');
				event.preventDefault(); // Evitar el envío del formulario solo si no se han seleccionado títulos
			}
		});

		document.getElementById('myform').addEventListener('submit', function(event) {
		// Prevenir el envío del formulario en caso de errores
		event.preventDefault();

		// Obtener los valores de los campos
		var firstName = document.getElementById('first_name').value.trim();
		var lastName = document.getElementById('last_name').value.trim();
		var email = document.getElementById('your_email').value.trim();
		var code = document.getElementById('code').value.trim();
		var docId = document.getElementById('doc_id').value.trim();
		var password = document.getElementById('password').value.trim();
		var repassword = document.getElementById('repassword').value.trim();
		var phone = document.getElementById('phone').value.trim();
		
		// Variables de validación
		var isValid = true;
		var errorMessage = '';

		// Validar campos vacíos
		if (firstName === '' || lastName === '' || email === '' || code === '' || docId === '' || password === '' || repassword === '' || phone === '') {
			isValid = false;
			errorMessage += 'Ningún campo debe estar vacío.\n';
		}

		// Validar Nombre y Apellido (mínimo 2 caracteres, sin números ni caracteres especiales)
		var namePattern = /^[a-zA-ZÀ-ÿ\u00f1\u00d1' ]{2,}$/;
		if (!namePattern.test(firstName)) {
			isValid = false;
			errorMessage += 'El nombre debe tener al menos 2 caracteres y no debe contener números ni caracteres especiales.\n';
		}
		if (!namePattern.test(lastName)) {
			isValid = false;
			errorMessage += 'El apellido debe tener al menos 2 caracteres y no debe contener números ni caracteres especiales.\n';
		}

		// Validar correo
		var emailPattern = /^[^\s@]+@[^\s@]+\.[a-zA-Z]{2,6}$/;
		if (!emailPattern.test(email)) {
			isValid = false;
			errorMessage += 'Correo electrónico no válido.\n';
		}

		// Validar código de país (solo dígitos)
		var codePattern = /^[0-9]+$/;
		if (!codePattern.test(code)) {
			isValid = false;
			errorMessage += 'El código de país debe contener solo dígitos.\n';
		}

		// Validar número de documento (mínimo 5 dígitos)
		if (docId.length < 5 || !codePattern.test(docId)) {
			isValid = false;
			errorMessage += 'El número de documento debe tener al menos 5 dígitos.\n';
		}

		// Validar contraseña (mínimo 5 caracteres, al menos una mayúscula, una minúscula)
		var passwordPattern = /^(?=.*[a-z])(?=.*[A-Z]).{5,}$/;
		if (!passwordPattern.test(password)) {
			isValid = false;
			errorMessage += 'La contraseña debe tener al menos 5 caracteres, una letra mayúscula y una letra minúscula.\n';
		}

		// Validar que ambas contraseñas coincidan
		if (password !== repassword) {
			isValid = false;
			errorMessage += 'Las contraseñas no coinciden.\n';
		}

		// Mostrar mensaje de error si alguna validación falla
		if (!isValid) {
			alert(errorMessage);
		} else {
			this.submit(); // Enviar el formulario si es válido
		}
	});

	</script>
</body><!-- This templates was made by Colorlib (https://colorlib.com) -->
</html>